<!DOCTYPE html><html lang="es"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><title>Reconoce el Patrón</title>
<style>*{margin:0;padding:0;box-sizing:border-box}body{font-family:Georgia,serif;background:linear-gradient(135deg,#0a0e27,#1a1034,#2d1b4e);min-height:100vh;color:#e8e8f0;display:flex;flex-direction:column;align-items:center;padding:8px}.title{font-size:1.3em;background:linear-gradient(135deg,#ffd700,#ff8c00);-webkit-background-clip:text;-webkit-text-fill-color:transparent}.subtitle{color:#d4af37;margin-bottom:6px;font-size:0.8em}.box{background:rgba(255,255,255,0.05);border:2px solid rgba(212,175,55,0.5);border-radius:12px;padding:10px;width:calc(100% - 16px);max-width:340px}.hidden{display:none!important}.banner,.back{padding:4px 8px;border-radius:8px;font-size:0.7em}.banner{background:rgba(255,215,0,0.2);border:1px solid rgba(255,215,0,0.5);color:#ffd700}.back{background:rgba(255,255,255,0.1);border:1px solid rgba(212,175,55,0.3);color:#ffd700;text-decoration:none}.top-bar{width:calc(100% - 16px);max-width:340px;display:flex;justify-content:space-between;align-items:center;margin-bottom:6px}.popup-bg{position:fixed;inset:0;background:rgba(0,0,0,0.85);display:flex;justify-content:center;align-items:center;z-index:5000}.popup{background:linear-gradient(135deg,#1a1034,#2d1b4e);border:2px solid rgba(255,215,0,0.3);border-radius:12px;padding:16px;width:90%;max-width:260px;text-align:center}.popup h3{color:#e8e8f0}.popup p{color:#a0a0b8;font-size:0.75em;margin:8px 0}.popup a{display:block;padding:8px;background:rgba(255,255,255,0.08);border:1px solid rgba(255,255,255,0.2);border-radius:6px;color:#e8e8f0;text-decoration:none;margin-bottom:10px}.btn{width:100%;background:linear-gradient(135deg,#ffd700,#ff8c00);color:#1a1034;border:none;padding:10px;border-radius:12px;font-weight:bold;cursor:pointer;margin-top:5px}.btn2{background:linear-gradient(135deg,#8a2be2,#4b0082);color:#fff}.pin-title{color:#ffd700;font-size:1em;text-align:center;margin-bottom:4px}.pin-sub{color:#b8b8cc;text-align:center;margin-bottom:12px;font-size:0.75em}.dots{display:flex;justify-content:center;gap:8px;margin-bottom:12px}.dot{width:12px;height:12px;border-radius:50%;border:2px solid rgba(212,175,55,0.5)}.dot.on{background:#ffd700;border-color:#ffd700}.keypad{display:grid;grid-template-columns:repeat(3,1fr);gap:5px;max-width:180px;margin:0 auto 10px}.key{aspect-ratio:1;font-size:1.1em;border:2px solid rgba(212,175,55,0.3);background:rgba(255,255,255,0.05);color:#e8e8f0;border-radius:6px;cursor:pointer}.key.empty{visibility:hidden}.msg{text-align:center;min-height:16px;font-size:0.75em}.msg.err{color:#ff6b6b}.msg.ok{color:#4ecdc4}.toggle{text-align:center;margin-top:10px;color:#b8b8cc;font-size:0.75em}.toggle span{color:#ffd700;cursor:pointer;text-decoration:underline}.welcome{background:rgba(255,215,0,0.1);border:1px solid rgba(255,215,0,0.3);border-radius:8px;padding:10px;margin-bottom:10px;text-align:center}.welcome h3{color:#ffd700}.welcome p{font-size:0.75em;color:#b8b8cc}.stats{display:grid;grid-template-columns:repeat(2,1fr);gap:6px;margin:10px 0}.stat{background:rgba(255,255,255,0.05);padding:8px;border-radius:6px;text-align:center;border:1px solid rgba(212,175,55,0.2)}.stat b{display:block;font-size:1.2em;color:#ffd700}.stat span{color:#b8b8cc;font-size:0.65em}.game-info{display:flex;justify-content:space-between;margin-bottom:8px}.game-stat{text-align:center}.game-stat b{display:block;font-size:1.1em;color:#ffd700}.game-stat span{color:#b8b8cc;font-size:0.65em}.pattern-area{background:rgba(0,0,0,0.3);border-radius:12px;padding:15px;margin:10px 0;text-align:center}.pattern-seq{display:flex;justify-content:center;gap:8px;flex-wrap:wrap;margin-bottom:15px;min-height:50px}.pattern-item{width:42px;height:42px;display:flex;align-items:center;justify-content:center;font-size:1.3em;background:rgba(255,255,255,0.1);border-radius:8px;border:2px solid rgba(212,175,55,0.3)}.pattern-item.q{background:rgba(255,215,0,0.2);border-color:#ffd700;color:#ffd700}.prompt{color:#b8b8cc;font-size:0.85em;margin-bottom:12px}.options{display:grid;grid-template-columns:repeat(2,1fr);gap:10px}.opt{padding:15px;font-size:1.3em;background:rgba(255,255,255,0.08);border:2px solid rgba(212,175,55,0.3);border-radius:10px;color:#e8e8f0;cursor:pointer}.opt.ok{background:rgba(46,204,113,0.3);border-color:#2ecc71}.opt.no{background:rgba(231,76,60,0.3);border-color:#e74c3c}.timer{height:6px;background:rgba(255,255,255,0.1);border-radius:3px;margin:8px 0;overflow:hidden}.timer div{height:100%;width:100%;background:linear-gradient(90deg,#e74c3c,#f39c12,#2ecc71)}.res-bg{position:fixed;inset:0;background:rgba(0,0,0,0.9);display:flex;justify-content:center;align-items:center;z-index:3000}.res{background:linear-gradient(135deg,#1a1034,#2d1b4e);border:2px solid #ffd700;border-radius:12px;padding:16px;width:90%;max-width:300px;text-align:center}.res h2{color:#ffd700}.res-score{font-size:2.5em;color:#ffd700;font-weight:bold}.res-label{color:#b8b8cc;margin-bottom:10px}.res-det{display:flex;justify-content:space-around;margin:10px 0}.res-det div b{display:block;color:#ffd700;font-size:1.2em}.res-det div span{color:#b8b8cc;font-size:0.7em}.record{background:rgba(255,215,0,0.2);border:1px solid #ffd700;border-radius:5px;padding:6px;margin:8px 0;color:#ffd700;font-weight:bold}.rating{color:#d4af37;margin-bottom:10px}.name-input{width:100%;padding:10px;background:rgba(255,255,255,0.1);border:2px solid rgba(212,175,55,0.5);border-radius:8px;color:#e8e8f0;font-size:1em;margin-bottom:10px;text-align:center}</style></head>
<body>
<div class="top-bar"><a href="https://hooporiapr-oss.github.io/akashic-works/" class="back">Inicio</a><div class="banner" id="ban">3 gratis</div></div>
<div class="title">Reconoce el Patrón</div><div class="subtitle">Puerto Rico</div>
<div class="box" id="loginBox"><div class="pin-title">Ingresa tu PIN</div><div class="pin-sub">Escribe tu PIN de 4 dígitos</div><div class="dots" id="ld"></div><div class="keypad" id="lk"></div><div class="msg" id="lm"></div><div class="toggle">¿No tienes cuenta? <span id="toC">Crear PIN</span></div></div>
<div class="box hidden" id="createBox"><div class="pin-title" id="ct">Crear PIN</div><div class="pin-sub" id="cs">Escoge un PIN de 4 dígitos</div><div class="dots" id="cd"></div><div class="keypad" id="ck"></div><div class="msg" id="cm"></div><div class="toggle">¿Ya tienes PIN? <span id="toL">Entrar</span></div></div>
<div class="box hidden" id="nameBox"><div class="pin-title">Nombre de Usuario</div><div class="pin-sub">Escoge un nombre</div><input type="text" class="name-input" id="nameIn" placeholder="Tu nombre" maxlength="15"><button class="btn" id="saveN">Guardar</button><div class="msg" id="nm"></div></div>
<div class="box hidden" id="dashBox"><div class="welcome"><h3 id="wn">¡Bienvenido!</h3><p>¡Encuentra el siguiente en la secuencia!</p></div><div class="stats"><div class="stat"><b id="dG">0</b><span>Juegos</span></div><div class="stat"><b id="dB">--</b><span>Mejor</span></div><div class="stat"><b id="dA">--</b><span>Promedio</span></div><div class="stat"><b id="dR">--</b><span>Nivel</span></div></div><button class="btn" id="startB">Comenzar</button><button class="btn btn2" id="outB">Salir</button></div>
<div class="box hidden" id="gameBox"><div class="game-info"><div class="game-stat"><b id="gR">1/15</b><span>Ronda</span></div><div class="game-stat"><b id="gS">0</b><span>Puntos</span></div><div class="game-stat"><b id="gK">0</b><span>Racha</span></div></div><div class="timer"><div id="tmr"></div></div><div class="pattern-area"><div class="pattern-seq" id="seq"></div><div class="prompt">¿Qué sigue?</div><div class="options" id="opts"></div></div><button class="btn btn2" id="quitB">Salir</button></div>
<div class="res-bg hidden" id="resB"><div class="res"><h2>Resultados</h2><div class="res-score" id="rsS">0</div><div class="res-label">Puntos</div><div class="res-det"><div><b id="rsC">0</b><span>Correctas</span></div><div><b id="rsK">0</b><span>Mejor Racha</span></div></div><div class="record hidden" id="rsR">¡Nuevo Récord!</div><div class="rating" id="rsRt">Nivel: --</div><button class="btn" id="again">Jugar Otra Vez</button><button class="btn btn2" id="menu">Menú</button></div></div>
<div class="popup-bg hidden" id="limP"><div class="popup"><h3 id="limT">Límite diario</h3><p id="limM">Usaste 3 juegos gratis</p><a href="https://hooporiapr-oss.github.io/akashic-works/">Volver al Inicio</a><button class="btn" id="upg">Desbloquear Ilimitado</button></div></div>
<script>
(function(){var PK="ak_pins",UK="ak_users",SK="pres_",DK="ak_dev",MD=3,MX=3,RDS=15,RT=8000;
var pin="",user=null,rnd=0,scr=0,cor=0,stk=0,bstk=0,ans="",tInt=null,tStart=0,wait=false;
function $(i){return document.getElementById(i)}
function h(p){var x=0,s=p+"ak";for(var i=0;i<s.length;i++){x=((x<<5)-x)+s.charCodeAt(i);x&=x}return x.toString(36)}
function gP(){try{return JSON.parse(localStorage.getItem(PK))||{}}catch(e){return{}}}
function sP(p){localStorage.setItem(PK,JSON.stringify(p))}
function cP(p){return!!gP()[h(p)]}
function aP(p){var ps=gP();ps[h(p)]={c:Date.now()};sP(ps)}
function gU(){try{return JSON.parse(localStorage.getItem(UK))||{}}catch(e){return{}}}
function sU(u){localStorage.setItem(UK,JSON.stringify(u))}
function gUsr(x){return gU()[x]||null}
function sUsr(x,d){var u=gU();u[x]=d;sU(u)}
function gDev(){var id=localStorage.getItem(DK);if(!id){id="d_"+Date.now()+"_"+Math.random().toString(36).substr(2,6);localStorage.setItem(DK,id)}return id}
function tdy(){var d=new Date();return d.getFullYear()+"-"+(d.getMonth()+1)+"-"+d.getDate()}
function gTr(){try{var t=JSON.parse(localStorage.getItem("ak_trial"));if(t&&t.sd)return t}catch(e){}return{n:0,d:tdy(),sd:tdy()}}
function sTr(t){localStorage.setItem("ak_trial",JSON.stringify(t))}
function dDif(s){return Math.floor((new Date()-new Date(s))/864e5)}
function canP(){var t=gTr(),td=tdy(),dy=dDif(t.sd);if(dy>=MX)return{ok:false,left:0,exp:true,dl:0};if(t.d!==td){t.n=0;t.d=td;sTr(t)}return{ok:t.n<MD,left:MD-t.n,exp:false,dl:MX-dy}}
function useT(){var t=gTr(),td=tdy();if(t.d!==td){t.n=0;t.d=td}t.n++;sTr(t);sBan()}
function gSt(){try{return JSON.parse(localStorage.getItem(SK+h(pin)))||{g:0,b:0,t:0}}catch(e){return{g:0,b:0,t:0}}}
function sSt(s){localStorage.setItem(SK+h(pin),JSON.stringify(s))}
function sBan(){var c=canP();$("ban").textContent=c.exp?"Prueba terminada":c.left+"/"+MD+" (Día "+c.dl+")"}
function sLim(){var c=canP();$("limT").textContent=c.exp?"Prueba terminada":"Límite diario";$("limM").textContent=c.exp?"Tu prueba de 3 días expiró":"Usaste "+MD+" juegos. "+c.dl+" día(s) restantes.";$("limP").classList.remove("hidden")}
function show(id){["loginBox","createBox","nameBox","dashBox","gameBox"].forEach(function(x){$(x).classList.add("hidden")});$(id).classList.remove("hidden")}
function dots(c,n){c.innerHTML="";for(var i=0;i<4;i++){var d=document.createElement("div");d.className="dot"+(i<n?" on":"");c.appendChild(d)}}
function msg(el,t,e){el.textContent=t;el.className="msg "+(e?"err":"ok")}
function rate(s){return s>=120?"Genio":s>=90?"Experto":s>=60?"Excelente":s>=30?"Bueno":"Aprendiz"}
var lPin="",cPin="",cfPin="",isCf=false;
function mkKp(cont,onD,onDel){cont.innerHTML="";for(var i=1;i<=9;i++){(function(d){var b=document.createElement("button");b.className="key";b.textContent=d;b.onclick=function(){onD(d)};cont.appendChild(b)})(i)}var e=document.createElement("button");e.className="key empty";cont.appendChild(e);var z=document.createElement("button");z.className="key";z.textContent="0";z.onclick=function(){onD(0)};cont.appendChild(z);var dl=document.createElement("button");dl.className="key";dl.textContent="←";dl.onclick=onDel;cont.appendChild(dl)}
function initL(){dots($("ld"),0);mkKp($("lk"),function(d){if(lPin.length<4){lPin+=d;dots($("ld"),lPin.length);if(lPin.length===4){setTimeout(function(){if(cP(lPin)){pin=lPin;user=gUsr(h(pin));if(user&&user.n)dash();else show("nameBox")}else{msg($("lm"),"PIN incorrecto",1);lPin="";dots($("ld"),0)}},200)}}},function(){if(lPin.length>0){lPin=lPin.slice(0,-1);dots($("ld"),lPin.length);$("lm").textContent=""}})}
function initC(){dots($("cd"),0);mkKp($("ck"),function(d){if(cfPin.length<4){cfPin+=d;dots($("cd"),cfPin.length);if(cfPin.length===4){setTimeout(function(){if(!isCf){cPin=cfPin;cfPin="";isCf=true;$("ct").textContent="Confirmar PIN";$("cs").textContent="Escribe el PIN otra vez";dots($("cd"),0)}else{if(cfPin===cPin){aP(cPin);pin=cPin;msg($("cm"),"¡PIN creado!",0);setTimeout(function(){show("nameBox")},400)}else{msg($("cm"),"PINs no coinciden",1);cPin="";cfPin="";isCf=false;$("ct").textContent="Crear PIN";$("cs").textContent="Escoge un PIN de 4 dígitos";dots($("cd"),0)}}},200)}}},function(){if(cfPin.length>0){cfPin=cfPin.slice(0,-1);dots($("cd"),cfPin.length);$("cm").textContent=""}})}
function dash(){var s=gSt();$("wn").textContent="¡Bienvenido, "+(user?user.n:"Jugador")+"!";$("dG").textContent=s.g||0;$("dB").textContent=s.b||"--";$("dA").textContent=s.g>0?Math.round(s.t/s.g):"--";$("dR").textContent=s.b?rate(s.b):"--";show("dashBox");sBan();if(!canP().ok)sLim()}
function genPat(){var type=Math.floor(Math.random()*6),seq=[],start=Math.floor(Math.random()*5)+1,step=Math.floor(Math.random()*4)+2;
if(type===0){for(var i=0;i<4;i++)seq.push(start+i*step);ans=""+(start+4*step)}
else if(type===1){for(var i=0;i<4;i++)seq.push(start*Math.pow(2,i));ans=""+(start*Math.pow(2,4))}
else if(type===2){for(var i=0;i<4;i++)seq.push((i+1)*(i+1));ans="25"}
else if(type===3){seq=[2,3,5,7];ans="11"}
else if(type===4){seq=[1,1,2,3];ans="5"}
else{for(var i=0;i<4;i++)seq.push(start-i*step);ans=""+(start-4*step)}
return{seq:seq,ans:ans}}
function mkOpts(correct){var opts=[correct];while(opts.length<4){var fake=parseInt(correct)+Math.floor(Math.random()*21)-10;if(fake!==parseInt(correct)&&opts.indexOf(""+fake)===-1)opts.push(""+fake)}
return opts.sort(function(){return Math.random()-0.5})}
function newRnd(){if(rnd>=RDS){endG();return}
wait=false;var p=genPat();ans=p.ans;var sq=$("seq");sq.innerHTML="";p.seq.forEach(function(v){var d=document.createElement("div");d.className="pattern-item";d.textContent=v;sq.appendChild(d)});var q=document.createElement("div");q.className="pattern-item q";q.textContent="?";sq.appendChild(q);
var opts=mkOpts(ans),oc=$("opts");oc.innerHTML="";opts.forEach(function(o){var b=document.createElement("button");b.className="opt";b.textContent=o;b.onclick=function(){if(!wait)chk(o,b)};oc.appendChild(b)});
tStart=Date.now();startT()}
function startT(){if(tInt)clearInterval(tInt);$("tmr").style.width="100%";tInt=setInterval(function(){var el=Date.now()-tStart,pct=Math.max(0,100-el/RT*100);$("tmr").style.width=pct+"%";if(el>=RT){clearInterval(tInt);chk(null,null)}},50)}
function chk(a,btn){if(wait)return;wait=true;if(tInt)clearInterval(tInt);rnd++;$("gR").textContent=rnd+"/"+RDS;
var btns=$("opts").children;if(a===ans){if(btn)btn.classList.add("ok");var tm=Math.max(0,RT-(Date.now()-tStart)),pts=Math.round(5+tm/200);scr+=pts;stk++;if(stk>bstk)bstk=stk;cor++}else{stk=0;if(btn)btn.classList.add("no");for(var i=0;i<btns.length;i++)if(btns[i].textContent===ans)btns[i].classList.add("ok")}
$("gS").textContent=scr;$("gK").textContent=stk;setTimeout(newRnd,700)}
function startG(){if(!canP().ok){sLim();return}rnd=0;scr=0;cor=0;stk=0;bstk=0;show("gameBox");$("gR").textContent="1/"+RDS;$("gS").textContent="0";$("gK").textContent="0";newRnd()}
function endG(){if(tInt){clearInterval(tInt);tInt=null}var s=gSt();s.g++;s.t+=scr;var rec=scr>s.b;if(rec)s.b=scr;sSt(s);useT();$("rsS").textContent=scr;$("rsC").textContent=cor;$("rsK").textContent=bstk;$("rsRt").textContent="Nivel: "+rate(scr);if(rec)$("rsR").classList.remove("hidden");else $("rsR").classList.add("hidden");$("resB").classList.remove("hidden");if(!canP().ok)setTimeout(sLim,1500)}
document.addEventListener("DOMContentLoaded",function(){gDev();initL();initC();
$("toC").onclick=function(){cPin="";cfPin="";isCf=false;$("ct").textContent="Crear PIN";$("cs").textContent="Escoge un PIN de 4 dígitos";dots($("cd"),0);$("cm").textContent="";show("createBox")};
$("toL").onclick=function(){lPin="";dots($("ld"),0);$("lm").textContent="";show("loginBox")};
$("saveN").onclick=function(){var n=$("nameIn").value.trim();if(n.length<2){msg($("nm"),"Muy corto",1);return}user={n:n,c:Date.now()};sUsr(h(pin),user);dash()};
$("startB").onclick=function(){if(!canP().ok){sLim();return}startG()};
$("outB").onclick=function(){lPin="";pin="";user=null;dots($("ld"),0);show("loginBox")};
$("quitB").onclick=function(){if(tInt){clearInterval(tInt);tInt=null}dash()};
$("again").onclick=function(){$("resB").classList.add("hidden");if(!canP().ok){sLim();return}startG()};
$("menu").onclick=function(){$("resB").classList.add("hidden");dash()};
$("upg").onclick=function(){location.href="mailto:support@akashic.works?subject=Pro%20Upgrade"};
show("loginBox");sBan()})})();
</script></body></html>
